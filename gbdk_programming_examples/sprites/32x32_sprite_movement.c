
// tested works fine

#define bg_dataWidth 20
#define bg_dataHeight 18
#define bg_dataBank 0

unsigned char bg_data[] =
{
  0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
  0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
  0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
  0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
  0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
  0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
  0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
  0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,
  0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x01,0x02,0x02,0x02,0x02,0x02,
  0x02,0x02,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x02,0x02,0x02,
  0x02,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x02,0x02,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x02,
  0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x01,0x01,0x00,0x01,0x01,0x01,
  0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,
  0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,
  0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,
  0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};


/* Start of tile array. */
unsigned char bg_sprite_dat[] =
{
  0x00,0x00,0x04,0x00,0x04,0x00,0x00,0x00,
  0x02,0x00,0x42,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x02,
  0x00,0x40,0x00,0x00,0x00,0x00,0x00,0x10,
  0x00,0x00,0x08,0x08,0x01,0x01,0x00,0x00,
  0x40,0x40,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};


// sprite
unsigned char bad_guy[] =
{
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x03,0x02,0x07,0x04,0x0F,0x08,
  0x1F,0x10,0x3F,0x20,0x7F,0x40,0xFF,0x81,
  0x00,0x00,0x80,0x80,0xC0,0x40,0xE0,0x20,
  0xF0,0x10,0xF8,0x08,0xFC,0x04,0xFE,0x02,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x01,0x01,0x03,0x02,0x07,0x04,0x0F,0x08,
  0x1F,0x11,0x3F,0x20,0x7F,0x40,0xFF,0x80,
  0xFF,0x01,0xFF,0x03,0xFF,0x03,0xFF,0x03,
  0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0xFF,0x1F,
  0xFF,0x01,0xFF,0x80,0xFF,0x80,0xFF,0x80,
  0xFF,0xFF,0xFF,0xFE,0xFF,0xFC,0xFF,0xF0,
  0x00,0x00,0x80,0x80,0xC0,0x40,0xE0,0x20,
  0xF0,0x10,0xF8,0x08,0xFC,0x04,0xFE,0x02,
  0xFF,0x80,0x7F,0x40,0x3F,0x20,0x1F,0x10,
  0x0F,0x08,0x07,0x04,0x03,0x02,0x01,0x01,
  0xFF,0x0F,0xFF,0x1F,0xFF,0x1F,0xFF,0x1E,
  0xFF,0x38,0xFF,0x20,0xFF,0x00,0xFF,0x00,
  0xFF,0xE0,0xFF,0xF0,0xFF,0xF0,0xFF,0xF0,
  0xFF,0x38,0xFF,0x08,0xFF,0x00,0xFF,0x01,
  0xFE,0x02,0xFC,0x04,0xF8,0x08,0xF0,0x10,
  0xE0,0x20,0xC0,0x40,0x80,0x80,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xFF,0x80,0x7F,0x40,0x3F,0x20,0x1F,0x10,
  0x0F,0x08,0x07,0x04,0x03,0x02,0x01,0x01,
  0xFE,0x02,0xFC,0x04,0xF8,0x08,0xF0,0x10,
  0xE0,0x20,0xC0,0x40,0x80,0x80,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};




#include <gb/gb.h>
#include <types.h>

#define SPR_WIDTH 4
#define SPR_HEIGHT 4
#define TOTAL_SPR SPR_WIDTH * SPR_HEIGHT

UINT8 x = 64;
UINT8 y = 96;

void render_huge_sprite() {
	UINT8 i, j;
	UINT8 sprite_index;

	set_sprite_tile(0, 1);

	for(i = 0; i < SPR_WIDTH; ++i) {
		for(j = 0; j < SPR_HEIGHT; ++j) {
			sprite_index = i * SPR_HEIGHT + j;
			set_sprite_tile(sprite_index, sprite_index);
			move_sprite(sprite_index, x + (j * 8), y + (i * 8));
		}
	}
}

void load_background() {
	set_bkg_data(0, 3, bg_sprite_dat);
	set_bkg_tiles(0, 0, 20, 18, bg_data); 
}

void move_huge_sprite(UINT8 nx, UINT8 ny) {
	UINT8 i, lx, ly;
	lx = 0;
	ly = 0;
	for(i = 0; i < 32; i++) {
		if(lx == 32) {
			lx = 0;
			ly += 8;
		}
		move_sprite(i, nx + lx, ny + ly);
		lx += 8;
	}	

}

void move_right() {
	move_huge_sprite(++x, y);
}

void move_left() {
	move_huge_sprite(--x, y);
}

void main() {
	SPRITES_8x8;
	set_sprite_data(0, 16, bad_guy);

	render_huge_sprite();
	load_background();

	SHOW_SPRITES;
	SHOW_BKG;

	while(1) {
		wait_vbl_done();
		if(joypad() & J_RIGHT) {
			move_right();
		}
		if(joypad() & J_LEFT) {
			move_left();
		}
    if (joypad() & J_UP) {
      move_huge_sprite(x, --y);
    }
    if (joypad() & J_DOWN) {
      move_huge_sprite(x, ++y);
    }
		delay(5);
	}
}