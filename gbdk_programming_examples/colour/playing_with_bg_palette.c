
#include <gb/gb.h>

#define map32Width 32
#define map32Height 32

UWORD pal[] = {RGB(31, 0, 0), RGB(10,10,10), RGB(6,0,0), RGB(0,0,0),
              RGB(0,31,0), RGB(0,0,31), RGB(31,0,31),RGB(31,31,31)};

unsigned char map32[] =
{
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x01,0x01,0x03,0x03,0x03,0x05,0x08,
  0x08,0x08,0x08,0x08,0x08,0x01,0x03,0x03,0x03,0x03,
  0x01,0x08,0x08,0x08,0x08,0x08,0x08,0x06,0x03,0x03,
  0x03,0x01,0x01,0x00,0x00,0x01,0x01,0x02,0x03,0x05,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,0x03,0x03,
  0x03,0x03,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x06,0x03,0x02,0x01,0x01,0x00,0x00,0x03,0x02,0x02,
  0x05,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,
  0x03,0x03,0x03,0x03,0x00,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x06,0x02,0x02,0x03,0x00,0x00,0x03,
  0x03,0x05,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x01,0x02,0x00,0x00,0x02,0x01,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x06,0x03,0x03,0x00,
  0x00,0x03,0x05,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x06,
  0x03,0x00,0x00,0x05,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x06,0x00,0x00,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,
  0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x00,0x00,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x02,0x02,0x02,
  0x04,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x07,0x02,0x02,0x02,0x00,0x00,0x03,
  0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x00,
  0x00,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,
  0x03,0x00,0x00,0x02,0x02,0x02,0x05,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x06,
  0x02,0x02,0x02,0x00,0x00,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,
  0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x00,0x00,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,
  0x00,0x04,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x07,0x00,0x00,0x03,0x04,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x08,0x01,0x02,0x02,0x00,0x00,0x02,
  0x02,0x01,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x07,0x03,0x00,0x00,0x03,0x03,0x04,0x08,0x08,
  0x08,0x08,0x08,0x08,0x08,0x08,0x00,0x03,0x03,0x03,
  0x03,0x03,0x03,0x00,0x08,0x08,0x08,0x08,0x08,0x08,
  0x08,0x08,0x07,0x03,0x03,0x00,0x00,0x03,0x02,0x02,
  0x04,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x00,0x03,
  0x03,0x03,0x03,0x03,0x03,0x00,0x08,0x08,0x08,0x08,
  0x08,0x08,0x08,0x07,0x02,0x02,0x03,0x00,0x00,0x01,
  0x01,0x02,0x03,0x04,0x08,0x08,0x08,0x08,0x08,0x08,
  0x00,0x03,0x03,0x03,0x03,0x03,0x03,0x00,0x08,0x08,
  0x08,0x08,0x08,0x08,0x07,0x03,0x02,0x01,0x01,0x00,
  0x00,0x01,0x01,0x03,0x03,0x03,0x04,0x08,0x08,0x08,
  0x08,0x08,0x01,0x03,0x03,0x03,0x03,0x03,0x03,0x01,
  0x08,0x08,0x08,0x08,0x08,0x07,0x03,0x03,0x03,0x01,
  0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00
};

/* Start of tile array. */
unsigned char bgdat[] =
{
  0xFF,0xFF,0x87,0xBF,0x83,0xEF,0xE1,0x9F,
  0x81,0x8F,0xB3,0xB5,0xF9,0xE7,0xFF,0xFF,
  0xFF,0xFF,0xFD,0x83,0xB1,0xCF,0x99,0xE7,
  0x89,0xF7,0xFF,0xC1,0xFF,0xE3,0xFF,0xFF,
  0xFF,0xFF,0x81,0xFF,0x81,0xED,0xE1,0x95,
  0xF1,0xCF,0x79,0x67,0x39,0x37,0xFF,0xFF,
  0xFF,0xFF,0xB1,0xB1,0xE3,0xE3,0xE1,0xE1,
  0x87,0x87,0xC5,0xC5,0x8F,0x8F,0xFF,0xFF,
  0x80,0x80,0xC0,0xC0,0xE0,0xE0,0xF0,0xF0,
  0xF8,0xF8,0xFC,0xFC,0xFE,0xFE,0xFF,0xFF,
  0xFF,0xFF,0xFE,0xFE,0xFC,0xFC,0xF8,0xF8,
  0xF0,0xF0,0xE0,0xE0,0xC0,0xC0,0x80,0x80,
  0xFF,0xFF,0x7F,0x7F,0x3F,0x3F,0x1F,0x1F,
  0x0F,0x0F,0x07,0x07,0x03,0x03,0x01,0x01,
  0x01,0x01,0x03,0x03,0x07,0x07,0x0F,0x0F,
  0x1F,0x1F,0x3F,0x3F,0x7F,0x7F,0xFF,0xFF,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

unsigned char cdatr[] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                     0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

UWORD redtones[] = {RGB(0,0,0), RGB(3,0,0), RGB(6,0,0), RGB(9,0,0), 
					RGB(12,0,0), RGB(15,0,0), RGB(18,0,0), RGB(21,0,0), 
					RGB(24,0,0), RGB(27,0,0), RGB(30,0,0)
				};

void main() {
  UBYTE x = 0;
  UBYTE y = 0;
  UBYTE r = 0;

  disable_interrupts();

  set_bkg_palette(0, 2, pal);
  set_bkg_data(0, 8, bgdat);
  VBK_REG = 1;
  set_bkg_tiles(0,0,32,32, cdatr);
  VBK_REG = 0;
  set_bkg_tiles(0,0,32,32,map32);

  DISPLAY_ON;
  enable_interrupts();
  SHOW_BKG;
  while (1) {
    SCY_REG = y;
    SCX_REG = x;
    if (joypad() & J_UP && y > 0) {
      y--;
    }
    if (joypad() & J_DOWN && y < 255) {
      y++;
    }
    if (joypad() & J_LEFT && x > 0) {
      x--;
    }
    if (joypad() & J_RIGHT && x < 255) {
      x++;
    }

    r++;
    if (r > 11) r = 0;
    pal[0] = redtones[r];
    set_bkg_palette(0,2,pal);

    wait_vbl_done();
  }
}

